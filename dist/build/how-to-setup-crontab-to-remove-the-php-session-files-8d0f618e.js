import{S as e,i as s,s as a,C as n,v as t,w as o,D as r,y as l,z as i,A as d,E as c,e as u,a as f,b as p,c as m,n as h,f as g}from"./main-552490a3.js";import{T as b}from"./Tutorial-42b2f2f1.js";function v(e){let s,a,n,t,o,r,l,i,d,c,b,v,y,T,w,k,H;return{c(){s=u("p"),s.innerHTML="Have you ever run out of hard drive space even when <em>df -h</em> tells there’s a lot of space still unused? I’ve been using Ubuntu and Debian for a long time, but have never before come against this kind of problem. I looked for the problem for a long time and deleted all possible unnecessary files from the disk, but the hard drive quickly refilled.",a=f(),n=u("p"),n.innerHTML="While looking for a solution to the problem, I found an software called <em>ncdu</em> (NCurses Disk Usage). Ncdu is a disk usage analyzer with an ncurses interface. It is designed to find space hogs on a remote server where you don’t have an entire graphical setup available. Like a gift from heaven.",t=f(),o=u("pre"),r=f(),l=u("p"),l.textContent="Ncdu is an awesome software for finding problems and it helped me find a 5.5 GB PHP sessions directory.",i=f(),d=u("p"),d.innerHTML="The server has been running for over three years and I have never cleaned old PHP session files. These files should be deleted with the correct setting in the <em>php.ini</em> file (<em>session.gc_maxlifetime</em>), but apparently it is not configured by default. There were 1 216 910 unnecessary files. Normal rm -f could not destroy the files, so had to look for an alternative solution and a simple perl script solved the problem.",c=f(),b=u("pre"),v=f(),y=u("p"),y.innerHTML="Ubuntu/Debian have a script (<em>/etc/cron.d/php</em>) to do the cleanup automatically, but I guess it’s broken. Because I like simple answers to problems, I added the following line to root <em>crontab</em>:",T=f(),w=u("pre"),k=f(),H=u("p"),H.textContent="The command destroys all files in the directory on Monday at 3:16. Problem solved.",p(o,"class","language-Shell"),p(b,"class","language-Bash"),p(w,"class","language-Crontab")},m(e,u){m(e,s,u),m(e,a,u),m(e,n,u),m(e,t,u),m(e,o,u),o.innerHTML='<code class="language-Shell">sudo apt install ncdu</code>',m(e,r,u),m(e,l,u),m(e,i,u),m(e,d,u),m(e,c,u),m(e,b,u),b.innerHTML='<code class="language-Bash">cd /var/lib/php/sessions\nperl -e &#39;for(&lt;*&gt;)&#123;((stat)[9]&lt;(unlink))&#125;&#39;</code>',m(e,v,u),m(e,y,u),m(e,T,u),m(e,w,u),w.innerHTML='<code class="language-Crontab">crontab -e\n16 3 * * 1 rm -f /var/lib/php/sessions/*</code>',m(e,k,u),m(e,H,u)},p:h,d(e){e&&g(s),e&&g(a),e&&g(n),e&&g(t),e&&g(o),e&&g(r),e&&g(l),e&&g(i),e&&g(d),e&&g(c),e&&g(b),e&&g(v),e&&g(y),e&&g(T),e&&g(w),e&&g(k),e&&g(H)}}}function y(e){let s,a;const u=[T];let f={$$slots:{default:[v]},$$scope:{ctx:e}};for(let e=0;e<u.length;e+=1)f=n(f,u[e]);return s=new b({props:f}),{c(){t(s.$$.fragment)},m(e,n){o(s,e,n),a=!0},p(e,[a]){const n=0&a?r(u,[c(T)]):{};1&a&&(n.$$scope={dirty:a,ctx:e}),s.$set(n)},i(e){a||(l(s.$$.fragment,e),a=!0)},o(e){i(s.$$.fragment,e),a=!1},d(e){d(s,e)}}}const T={title:"Remove unnecessary PHP sessions files on Debian",pub:[10,"Apr"],published:"2020-04-09T22:06:14.000Z",modified:"2020-04-09T22:16:53.000Z",summary:"How to find hidden system files that keep filling hard drives and how to remove old and unnecessary PHP session files.",layout:"tutorial"};export default class extends e{constructor(e){super(),s(this,e,null,y,a,{})}}export{T as metadata};
//# sourceMappingURL=how-to-setup-crontab-to-remove-the-php-session-files-8d0f618e.js.map
